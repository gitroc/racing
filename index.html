<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>超级耐力赛车</title>
    <link rel="icon" type="image/GIF" href="res/favicon.ico"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="full-screen" content="yes"/>
    <meta name="screen-orientation" content="portrait"/>
    <meta name="x5-fullscreen" content="true"/>
    <meta name="360-fullscreen" content="true"/>
    <style>
        body, canvas, div {
            -moz-user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
            -khtml-user-select: none;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        }
    </style>
    <div id='wx_pic' style='margin:0 auto;display:none;'>
        <img src='res/logo.png' />
    </div>
</head>
<body style="padding:0; margin: 0; background: #000;">
<canvas id="gameCanvas" width="800" height="450"></canvas>
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script src="src/jquery-1.7.2.min.js"></script>
<script src="frameworks/cocos2d-html5/CCBoot.js"></script>
<script cocos src="main.js"></script>
<script>
    $(document).ready(function(){
        init();
        initWeixin();
    });
    function init() {
        var href = window.location.href;
        base = href;
        lastpt = href.lastIndexOf(".");
        last = href.lastIndexOf("/");

        if (last != -1 && lastpt > last) {
            base = base.substr(0, last);
        }

        var path = base + "/res/logo.png";

        $("img").attr("src", path);
    };

    function initWeixin() {
        $.post(
            "http://******",
            {
            "url":window.location.href},
            function(data,status){
            data=eval("("+data+")");

        });
    };

    window.wxData = {
        "desc":"超级耐力赛车",
        "title":"超级耐力赛车"
    };
    window.wxFriend = {
        "desc":"超级耐力赛车",
        "title":"超级耐力赛车"
    };

    (function(ws){
        ws.shareMessage = function(title, message){
            title = title || wxFriend.title;
            message = message || wxFriend.desc;
            wx.onMenuShareTimeline({
                title: title, // 分享标题
                link: 'http://w.pre.chexiang.com/game/index.html', // 分享链接
                imgUrl: 'http://w.pre.chexiang.com/game/res/logo.png', // 分享图标
                trigger: function (res) {
                    // 不要尝试在trigger中使用ajax异步请求修改本次分享的内容，因为客户端分享操作是一个同步操作，这时候使用ajax的回包会还没有返回
                    alert('用户点击分享到朋友圈');
                },
                success: function () {
                    // 用户确认分享后执行的回调函数
                    alert('已分享');
                },
                cancel: function () {
                    // 用户取消分享后执行的回调函数
                    alert("cancel");
                }
            });

            wx.onMenuShareAppMessage({
                title: title, // 分享标题
                link: 'http://w.pre.chexiang.com/game/index.html', // 分享链接
                imgUrl: 'http://w.pre.chexiang.com/game/res/logo.png', // 分享图标
                success: function () {
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () {
                    // 用户取消分享后执行的回调函数
                }
            });

            wx.onMenuShareQQ({
                title: title, // 分享标题
                link: 'http://w.pre.chexiang.com/game/index.html', // 分享链接
                imgUrl: 'http://w.pre.chexiang.com/game/res/logo.png', // 分享图标
                success: function () {
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () {
                    // 用户取消分享后执行的回调函数
                }
            });

            wx.onMenuShareWeibo({
                title: title, // 分享标题
                link: 'http://w.pre.chexiang.com/game/index.html', // 分享链接
                imgUrl: 'http://w.pre.chexiang.com/game/res/logo.png', // 分享图标
                success: function () {
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () {
                    // 用户取消分享后执行的回调函数
                }
            });
        };
    })(window);
    wx.config({
        debug: true,
        appId: 'wxdd50ee3fac8f6f66',
        timestamp: 1420870884,
        nonceStr: 'VQhYOUJRz6RolHqN',
        signature: '892c2861b8bdb0cd42e45d7884fc44c7a2374d5e',
        jsApiList: [
            'checkJsApi',
            'onMenuShareTimeline',
            'onMenuShareAppMessage',
            'onMenuShareQQ',
            'onMenuShareWeibo',
            'closeWindow'
        ]
    });

    wx.ready(function(){
        //
        window.wxReady = true;
    });



    wx.error(function(res){
        //
        <!--alert("wx.error");-->
    });
</script>
</body>
</html>
